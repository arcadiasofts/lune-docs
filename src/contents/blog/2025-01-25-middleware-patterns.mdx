---
title: 'Orbital ë¯¸ë“¤ì›¨ì–´ íŒ¨í„´: Express.js ê°œë°œìë¥¼ ìœ„í•œ ê°€ì´ë“œ'
description: 'Express.jsì—ì„œ Orbitalë¡œ ì „í™˜í•˜ëŠ” ê°œë°œìë“¤ì„ ìœ„í•œ ë¯¸ë“¤ì›¨ì–´ íŒ¨í„´ ë¹„êµì™€ í™œìš©ë²•ì„ ì†Œê°œí•©ë‹ˆë‹¤.'
pubDate: 2025-01-25
author: 'Arcadia Team'
thumbnail: '/blog/thumbnails/2025-01-25.png'
---

## Express.jsì—ì„œ Orbitalë¡œ

ë§ì€ ê°œë°œìë“¤ì´ Express.jsì˜ ë¯¸ë“¤ì›¨ì–´ íŒ¨í„´ì— ìµìˆ™í•©ë‹ˆë‹¤. Orbitalì€ ì´ëŸ° ì¹œìˆ™í•¨ì„ ìœ ì§€í•˜ë©´ì„œë„ Rustì˜ ì¥ì ì„ í™œìš©í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

## ê¸°ë³¸ ë¯¸ë“¤ì›¨ì–´ ë¹„êµ

### Express.js ìŠ¤íƒ€ì¼

```javascript
const express = require('express');
const app = express();

// ë¡œê¹… ë¯¸ë“¤ì›¨ì–´
app.use((req, res, next) => {
  console.log(`${req.method} ${req.path} - ${new Date()}`);
  next();
});

// CORS ë¯¸ë“¤ì›¨ì–´
app.use((req, res, next) => {
  res.header('Access-Control-Allow-Origin', '*');
  res.header('Access-Control-Allow-Methods', 'GET,PUT,POST,DELETE');
  next();
});

app.get('/api/users', (req, res) => {
  res.json({ users: [] });
});
```

### Orbital ìŠ¤íƒ€ì¼

```rust
use orbital::router::Router;
use orbital::application::OrbitApplication;

let mut app = OrbitApplication::new(
    Some("Express-like Server".to_string()),
    None,
    None
);

let mut router = Router::new("API Router");

// ë¡œê¹… ë¯¸ë“¤ì›¨ì–´
router.use_logger();

// CORS ë¯¸ë“¤ì›¨ì–´
router.use_cors();

// ë¼ìš°íŠ¸ í•¸ë“¤ëŸ¬
router.read("/api/users", Arc::new(|_ctx| {
    Ok(RouteResponse::json(json!({ "users": [] })))
}));

app.register(router)?;
```

## ê³ ê¸‰ ë¯¸ë“¤ì›¨ì–´ íŒ¨í„´

### 1. ì¸ì¦ ë¯¸ë“¤ì›¨ì–´

**Express.js:**

```javascript
const jwt = require('jsonwebtoken');

function authenticateToken(req, res, next) {
  const authHeader = req.headers['authorization'];
  const token = authHeader && authHeader.split(' ')[1];

  if (!token) {
    return res.sendStatus(401);
  }

  jwt.verify(token, process.env.ACCESS_TOKEN_SECRET, (err, user) => {
    if (err) return res.sendStatus(403);
    req.user = user;
    next();
  });
}

app.use('/api/protected', authenticateToken);
```

**Orbital:**

```rust
use orbital::router::{Middleware, MiddlewareBuilder};

struct AuthMiddleware {
    secret_key: String,
}

impl AuthMiddleware {
    fn new(secret_key: String) -> Self {
        Self { secret_key }
    }
}

#[async_trait::async_trait]
impl Middleware for AuthMiddleware {
    async fn handle(
        &self,
        req: LUNE,
        next: Next,
    ) -> Result<RouteResponse, Box<dyn std::error::Error>> {
        let auth_header = req.header().get_custom_field("Authorization");

        if let Some(auth_value) = auth_header {
            if let Some(token) = auth_value.strip_prefix("Bearer ") {
                // JWT ê²€ì¦ ë¡œì§
                if self.verify_token(token).is_ok() {
                    return next.run(req).await;
                }
            }
        }

        Ok(RouteResponse::error(401, "Unauthorized"))
    }
}

// ì‚¬ìš©ë²•
let mut protected_router = Router::with_base_path("Protected API", "/api/protected");
protected_router.use_middleware(AuthMiddleware::new("your_secret_key".to_string()));
```

### 2. ìš”ì²­ ì œí•œ (Rate Limiting)

**Express.js:**

```javascript
const rateLimit = require('express-rate-limit');

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15ë¶„
  max: 100, // ìµœëŒ€ 100ê°œ ìš”ì²­
  message: 'Too many requests from this IP',
});

app.use('/api/', limiter);
```

**Orbital:**

```rust
use std::collections::HashMap;
use std::sync::{Arc, Mutex};
use std::time::{SystemTime, UNIX_EPOCH};

struct RateLimitMiddleware {
    requests: Arc<Mutex<HashMap<String, Vec<u64>>>>,
    max_requests: usize,
    window_ms: u64,
}

impl RateLimitMiddleware {
    fn new(max_requests: usize, window_ms: u64) -> Self {
        Self {
            requests: Arc::new(Mutex::new(HashMap::new())),
            max_requests,
            window_ms,
        }
    }
}

#[async_trait::async_trait]
impl Middleware for RateLimitMiddleware {
    async fn handle(
        &self,
        req: LUNE,
        next: Next,
    ) -> Result<RouteResponse, Box<dyn std::error::Error>> {
        let client_ip = req.header().get_custom_field("X-Forwarded-For")
            .or_else(|| req.header().get_custom_field("X-Real-IP"))
            .unwrap_or("unknown".to_string());

        let now = SystemTime::now()
            .duration_since(UNIX_EPOCH)
            .unwrap()
            .as_millis() as u64;

        let mut requests = self.requests.lock().unwrap();
        let client_requests = requests.entry(client_ip.clone()).or_insert_with(Vec::new);

        // ìœˆë„ìš° ë°–ì˜ ìš”ì²­ë“¤ ì œê±°
        client_requests.retain(|&timestamp| {
            now - timestamp < self.window_ms
        });

        if client_requests.len() >= self.max_requests {
            return Ok(RouteResponse::error(429, "Too Many Requests"));
        }

        client_requests.push(now);

        next.run(req).await
    }
}

// ì‚¬ìš©ë²•
let mut api_router = Router::with_base_path("API", "/api");
api_router.use_middleware(RateLimitMiddleware::new(100, 15 * 60 * 1000)); // 15ë¶„ì— 100ê°œ
```

### 3. ìš”ì²­/ì‘ë‹µ ë³€í™˜

**Express.js:**

```javascript
// ìš”ì²­ ë°”ë”” ë³€í™˜
app.use(express.json());
app.use((req, res, next) => {
  if (req.body && req.body.timestamp) {
    req.body.timestamp = new Date(req.body.timestamp);
  }
  next();
});

// ì‘ë‹µ ì••ì¶•
const compression = require('compression');
app.use(compression());
```

**Orbital:**

```rust
struct RequestTransformMiddleware;

#[async_trait::async_trait]
impl Middleware for RequestTransformMiddleware {
    async fn handle(
        &self,
        mut req: LUNE,
        next: Next,
    ) -> Result<RouteResponse, Box<dyn std::error::Error>> {
        // ìš”ì²­ ë°”ë”” ë³€í™˜
        if let Ok(mut body_json) = serde_json::from_slice::<serde_json::Value>(&req.body()) {
            if let Some(timestamp_str) = body_json.get("timestamp").and_then(|v| v.as_str()) {
                if let Ok(datetime) = chrono::DateTime::parse_from_rfc3339(timestamp_str) {
                    body_json["timestamp"] = json!(datetime.with_timezone(&chrono::Utc));
                    req.set_body(serde_json::to_vec(&body_json)?);
                }
            }
        }

        let response = next.run(req).await?;

        // ì‘ë‹µ ì••ì¶• (ì˜ˆì‹œ)
        let compressed_response = self.compress_response(response)?;

        Ok(compressed_response)
    }
}
```

## ë¯¸ë“¤ì›¨ì–´ ì²´ì´ë‹ê³¼ ìˆœì„œ

### Express.jsì—ì„œì˜ ìˆœì„œ

```javascript
app.use(cors()); // 1. CORS ì²˜ë¦¬
app.use(helmet()); // 2. ë³´ì•ˆ í—¤ë”
app.use(compression()); // 3. ì‘ë‹µ ì••ì¶•
app.use(express.json()); // 4. JSON íŒŒì‹±
app.use(rateLimiter); // 5. ìš”ì²­ ì œí•œ
app.use(authenticate); // 6. ì¸ì¦
app.use(logger); // 7. ë¡œê¹… (ë§ˆì§€ë§‰)
```

### Orbitalì—ì„œì˜ ìˆœì„œ

```rust
let mut router = Router::new("Ordered Middleware Router");

router
    .use_cors()                                    // 1. CORS ì²˜ë¦¬
    .use_middleware(SecurityHeadersMiddleware)     // 2. ë³´ì•ˆ í—¤ë”
    .use_middleware(CompressionMiddleware)         // 3. ì‘ë‹µ ì••ì¶•
    .use_middleware(RateLimitMiddleware::new(100, 60000)) // 4. ìš”ì²­ ì œí•œ
    .use_middleware(AuthMiddleware::new("secret".to_string())) // 5. ì¸ì¦
    .use_logger();                                 // 6. ë¡œê¹… (ë§ˆì§€ë§‰)
```

## ì—ëŸ¬ ì²˜ë¦¬ ë¯¸ë“¤ì›¨ì–´

**Express.js:**

```javascript
// ì—ëŸ¬ í•¸ë“¤ë§ ë¯¸ë“¤ì›¨ì–´ (ë§ˆì§€ë§‰ì— ìœ„ì¹˜)
app.use((err, req, res, next) => {
  console.error(err.stack);

  if (err.name === 'ValidationError') {
    return res.status(400).json({ error: err.message });
  }

  if (err.name === 'UnauthorizedError') {
    return res.status(401).json({ error: 'Unauthorized' });
  }

  res.status(500).json({ error: 'Internal Server Error' });
});
```

**Orbital:**

```rust
struct ErrorHandlingMiddleware;

#[async_trait::async_trait]
impl Middleware for ErrorHandlingMiddleware {
    async fn handle(
        &self,
        req: LUNE,
        next: Next,
    ) -> Result<RouteResponse, Box<dyn std::error::Error>> {
        match next.run(req).await {
            Ok(response) => Ok(response),
            Err(error) => {
                eprintln!("ì—ëŸ¬ ë°œìƒ: {}", error);

                // ì—ëŸ¬ íƒ€ì…ë³„ ì²˜ë¦¬
                if let Some(validation_error) = error.downcast_ref::<ValidationError>() {
                    return Ok(RouteResponse::error(400, &validation_error.to_string()));
                }

                if let Some(_auth_error) = error.downcast_ref::<AuthError>() {
                    return Ok(RouteResponse::error(401, "Unauthorized"));
                }

                Ok(RouteResponse::error(500, "Internal Server Error"))
            }
        }
    }
}

// ë¯¸ë“¤ì›¨ì–´ ì²´ì¸ ë§ˆì§€ë§‰ì— ì¶”ê°€
router.use_middleware(ErrorHandlingMiddleware);
```

## ì„±ëŠ¥ ë¹„êµ

### ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰

```rust
// Express.js: ê° ìš”ì²­ë§ˆë‹¤ ìƒˆë¡œìš´ ê°ì²´ ìƒì„±
// req.user = decoded; // ìƒˆë¡œìš´ í”„ë¡œí¼í‹° ì¶”ê°€
// req.custom_data = {}; // ëŸ°íƒ€ì„ì— ë™ì  ì¶”ê°€

// Orbital: ì»´íŒŒì¼ íƒ€ì„ì— íƒ€ì… í™•ì •, Zero-cost abstractions
struct AuthenticatedContext {
    user: User,
    permissions: Vec<Permission>,
}
```

### ì²˜ë¦¬ ì†ë„

ë²¤ì¹˜ë§ˆí¬ ê²°ê³¼ (1000ê°œ ìš”ì²­ ê¸°ì¤€):

| ë¯¸ë“¤ì›¨ì–´ | Express.js | Orbital | ê°œì„ ìœ¨ |
| -------- | ---------- | ------- | ------ |
| ë¡œê¹…     | 45ms       | 12ms    | 3.75x  |
| ì¸ì¦     | 120ms      | 35ms    | 3.43x  |
| CORS     | 25ms       | 8ms     | 3.13x  |
| ì¢…í•©     | 190ms      | 55ms    | 3.45x  |

## ì‹¤ì „ ì˜ˆì œ: ë¸”ë¡œê·¸ API

ì™„ì „í•œ ë¸”ë¡œê·¸ APIë¥¼ ë¯¸ë“¤ì›¨ì–´ì™€ í•¨ê»˜ êµ¬í˜„í•´ë³´ê² ìŠµë‹ˆë‹¤:

```rust
use orbital::application::OrbitApplication;
use orbital::router::Router;

#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    let mut app = OrbitApplication::new(
        Some("Blog API".to_string()),
        Some("Orbital ê¸°ë°˜ ë¸”ë¡œê·¸ API".to_string()),
        Some("1.0.0".to_string())
    );

    // ê³µê°œ ë¼ìš°í„°
    let mut public_router = Router::with_base_path("Public API", "/api/public");
    public_router
        .use_cors()
        .use_logger()
        .use_middleware(RateLimitMiddleware::new(1000, 60000)); // ë¶„ë‹¹ 1000ê°œ ìš”ì²­

    public_router.read("/posts", Arc::new(|_ctx| {
        // ê³µê°œ ê²Œì‹œë¬¼ ëª©ë¡
        Ok(RouteResponse::json(json!({
            "posts": [
                {"id": 1, "title": "ê³µê°œ ê²Œì‹œë¬¼", "public": true}
            ]
        })))
    }));

    // ê´€ë¦¬ì ë¼ìš°í„°
    let mut admin_router = Router::with_base_path("Admin API", "/api/admin");
    admin_router
        .use_cors()
        .use_middleware(RateLimitMiddleware::new(100, 60000))  // ë¶„ë‹¹ 100ê°œ ìš”ì²­
        .use_middleware(AuthMiddleware::new("admin_secret".to_string()))
        .use_middleware(AdminOnlyMiddleware)
        .use_logger();

    admin_router.create("/posts", Arc::new(|ctx| {
        // ê²Œì‹œë¬¼ ìƒì„± (ê´€ë¦¬ìë§Œ)
        let title = ctx.body_field("title")
            .and_then(|v| v.as_str())
            .ok_or("Title is required")?;

        Ok(RouteResponse::created(json!({
            "id": 123,
            "title": title,
            "created_at": chrono::Utc::now()
        })))
    }));

    app.register(public_router)?;
    app.register(admin_router)?;

    println!("ğŸš€ ë¸”ë¡œê·¸ API ì„œë²„ê°€ 8080 í¬íŠ¸ì—ì„œ ì‹œì‘ë©ë‹ˆë‹¤...");
    app.listen(8080).await?;

    Ok(())
}
```

## ë§ˆë¬´ë¦¬

Orbitalì˜ ë¯¸ë“¤ì›¨ì–´ ì‹œìŠ¤í…œì€ Express.jsì˜ ì¹œìˆ™í•¨ì„ ìœ ì§€í•˜ë©´ì„œë„ Rustì˜ ì„±ëŠ¥ê³¼ ì•ˆì •ì„±ì„ ì œê³µí•©ë‹ˆë‹¤. íƒ€ì… ì•ˆì •ì„±, ë©”ëª¨ë¦¬ ì•ˆì •ì„±, ê·¸ë¦¬ê³  ë›°ì–´ë‚œ ì„±ëŠ¥ì„ ëª¨ë‘ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Orbitalì˜ ì´ë²¤íŠ¸ ì‹œìŠ¤í…œì„ í™œìš©í•œ ì‹¤ì‹œê°„ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¶•ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤!

---

**ì°¸ê³  ìë£Œ:**

- [Orbital ë¯¸ë“¤ì›¨ì–´ ë¬¸ì„œ](/docs/orbital/router/middleware)
- [Express.js ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ](/docs/orbital/migration-guide)
- [ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬](https://github.com/arcadiasofts/orbital-benchmarks)

**Arcadia Team** âš¡
